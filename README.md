# Design Inhibitor for HPIV-3

This repository contains the code and instructions to reproduce the results from Xuan's Bachelor's Thesis, titled **MPNN-based Design of Novel Inhibitors for Human Parainfluenza Virus 3**. Below is a complete guide to replicate the study.

## Overview of the Design Pipeline

This study developed a computational framework to design small molecule inhibitors targeting the hemagglutinin-neuraminidase (HN) protein of Human Parainfluenza Virus 3 (HPIV-3). The framework integrates:

- **AutoDock** for molecular docking
- **Chemprop** message passing neural networks (MPNN)
- **Monte Carlo Tree Search (MCTS)** for molecule generation
- **ADMET** property prediction for virtual screening

![HPIV-3 Pipeline](https://github.com/Shawna22/Design-Inhibitor-for-HPIV-3/blob/main/HPIV3_Pipeline.png)

## Step 1: Set Up Software and Dependencies

The author recommends using a Conda environment for easy setup. A YAML file (`inhibitor_HPIV.yml`) is provided to configure the environment. Refer to the official documentation for [Chemprop](https://chemprop.readthedocs.io/) and [AutoDock](http://autodock.scripps.edu/) for additional setup details.

```bash
conda env create -f inhibitor_HPIV.yml
```

Activate the Conda environment before proceeding with the following steps:

```bash
conda activate inhibitor_HPIV
```

## Step 2: Clustering

Starting with 17 experimentally verified small molecules known to inhibit the HPIV-3 HN protein, we used RDKit to calculate Morgan fingerprints for each molecule. Tanimoto coefficients were computed between molecule pairs, and the Butina algorithm was applied to cluster molecules using a Tanimoto coefficient threshold of 0.7. Murcko scaffolds were generated for each cluster. A notebook is provided here.

```bash
clustering.ipynb
```

## Step 3: SmallWorld Search

A similarity search was conducted using the [SmallWorld](https://sw.docking.org/search.html) tool. Five common scaffolds, each representing one of the five clusters from Step 2, were used as input. Custom search parameters were applied to collect similar molecules from the ZINC-ALL-22Q2 molecular library.

Visit [SmallWorld](https://sw.docking.org/search.html) to perform the search.

## Step 4: Docking

The 3D structure of the target protein was extracted from PDB ID [1V3D](https://www.rcsb.org/structure/1V3D). AutoDock was used to perform molecular docking between the small molecules and the target binding site.

```bash
python preparing.py
python docking.py
```

## Step 5: Chemprop MPNN Model Training

A configuration file (`config.toml`) is provided for training the Chemprop MPNN model. The training data is available upon request from the author (xuanliushawna@gmail.com).

Run the following command to train the model:

```bash
chemprop train \
    --task-type classification \
    --output-dir your_output_dir \
    --config-path config.toml \
    --splits-column split \
    --data-path data_split_300.csv \
    --metrics binary-mcc roc prc accuracy f1 \
    --show-individual-scores \
    --num-folds 10 \
    --epochs 32 \
    --batch-size 32 \
    --ensemble-size 1
```

Replace `your_output_dir` with your desired output directory.

## Step 6: Monte Carlo Tree Search

Run the Monte Carlo Tree Search to generate novel molecules:

```bash
python MCTS.py
```

## Step 7: ADMET Prediction

The small molecules generated by Monte Carlo Tree Search were evaluated for ADMET properties using the [ADMET-AI](https://admet.ai.greenstonebio.com/) model, with ATC code `J05` as the reference set.

## Conclusion

For detailed implementation, refer to the thesis documents:
- [Thesis_Chinese_ver.pdf](Thesis_Chinese_ver.pdf)
- [Thesis_English_ver.pdf](Thesis_English_ver.pdf)

For questions or additional data, contact the author at [xuanliushawna@gmail.com](mailto:xuanliushawna@gmail.com).
